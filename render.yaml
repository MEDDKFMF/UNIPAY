services:
  - type: web
    name: unipay-backend
    env: python
    plan: free
    region: oregon
    branch: main
    autoDeploy: true
    buildCommand: |
      pip install -r backend/requirements.txt
      python backend/manage.py migrate
      python backend/manage.py collectstatic --noinput
    startCommand: |
      gunicorn core.wsgi:application --chdir backend --bind 0.0.0.0:10000

  - type: static
    name: unipay-frontend
    rootDir: frontend
    buildCommand: npm ci && npm run build
    publishPath: build
